"use strict";(()=>{var e={};e.id=5466,e.ids=[5466],e.modules={19932:(e,r,t)=>{t.r(r),t.d(r,{config:()=>f,default:()=>l,routeModule:()=>c});var n={};t.r(n),t.d(n,{default:()=>d});var o=t(64592),i=t(46387),s=t(49211),a=t(61871),u=t(74253);async function d(e,r){if("GET"!==e.method)return r.status(405).json({error:"Method not allowed"});let t=e.headers.authorization;if(!t||!t.startsWith("Bearer "))return r.status(401).json({error:"Missing token"});let n=t.split(" ")[1];try{let e=(0,u.J)(n).sub,[t]=await a.d.query("SELECT id, email, name, created_at FROM users WHERE id = ?",[e]);if(!t.length)return r.status(404).json({error:"User not found"});let o=t[0];return r.status(200).json({user:o})}catch(e){return console.error(e),r.status(401).json({error:"Invalid or expired token"})}}let l=(0,s.M)(n,"default"),f=(0,s.M)(n,"config"),c=new o.PagesAPIRouteModule({definition:{kind:i.A.PAGES_API,page:"/api/auth/me",pathname:"/api/auth/me",bundlePath:"",filename:""},userland:n})},46387:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},49211:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},61871:(e,r,t)=>{t.d(r,{d:()=>l});let n=require("mysql2/promise");var o=t.n(n);let{MYSQL_HOST:i,MYSQL_PORT:s,MYSQL_USER:a,MYSQL_PASSWORD:u,MYSQL_DATABASE:d}=process.env;if(!i||!a||!d)throw Error("Missing MySQL environment variables");let l=o().createPool({host:i,port:Number(s||3306),user:a,password:u,database:d,connectionLimit:10})},64592:(e,r,t)=>{e.exports=t(75600)},74253:(e,r,t)=>{t.d(r,{N:()=>a,J:()=>u});let n=require("jsonwebtoken");var o=t.n(n);let i=process.env.JWT_SECRET,s=process.env.JWT_EXPIRES_IN||"7d";if(!i)throw Error("Missing JWT_SECRET in environment");function a(e){return o().sign(e,i,{expiresIn:s})}function u(e){return o().verify(e,i)}},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")}};var r=require("../../../webpack-api-runtime.js");r.C(e);var t=r(r.s=19932);module.exports=t})();